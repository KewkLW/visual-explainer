<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KEWK Fitness App — System Flow</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=Share+Tech+Mono&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  /* ============ THEME — Dark-first industrial amber ============ */
  :root {
    --font-body: 'Space Grotesk', system-ui, sans-serif;
    --font-display: 'Chakra Petch', 'Space Grotesk', sans-serif;
    --font-mono: 'Share Tech Mono', 'SF Mono', Consolas, monospace;

    --bg: #0a0a08;
    --surface: #141410;
    --surface2: #1c1c16;
    --surface-elevated: #222218;
    --border: rgba(255, 204, 0, 0.08);
    --border-bright: rgba(255, 204, 0, 0.18);
    --text: #e8e4d0;
    --text-dim: #8a856e;

    --primary: #ffcc00;
    --primary-dim: rgba(255, 204, 0, 0.08);
    --auth: #ff6b35;
    --auth-dim: rgba(255, 107, 53, 0.1);
    --combat: #ff3333;
    --combat-dim: rgba(255, 51, 51, 0.1);
    --fuel: #33cc66;
    --fuel-dim: rgba(51, 204, 102, 0.1);
    --recovery: #6b8aff;
    --recovery-dim: rgba(107, 138, 255, 0.1);
    --settings: #9966ff;
    --settings-dim: rgba(153, 102, 255, 0.1);
    --monetize: #ff9900;
    --monetize-dim: rgba(255, 153, 0, 0.1);
    --program: #00cccc;
    --program-dim: rgba(0, 204, 204, 0.1);

    --hazard-a: #ffcc00;
    --hazard-b: #000000;
  }

  @media (prefers-color-scheme: light) {
    :root {
      --bg: #f5f3ec;
      --surface: #ffffff;
      --surface2: #f0ede4;
      --surface-elevated: #ffffff;
      --border: rgba(0, 0, 0, 0.08);
      --border-bright: rgba(0, 0, 0, 0.15);
      --text: #1a1a0e;
      --text-dim: #6b6650;
      --primary: #b38f00;
      --primary-dim: rgba(179, 143, 0, 0.06);
      --auth: #cc5528;
      --combat: #cc2929;
      --fuel: #1a8040;
      --recovery: #4466cc;
      --settings: #6b3fd4;
      --monetize: #cc7a00;
      --program: #008080;
    }
  }

  /* ============ RESET ============ */
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background-color: var(--bg);
    background-image:
      radial-gradient(circle, var(--border) 1px, transparent 1px),
      radial-gradient(ellipse at 50% 0%, rgba(255,204,0,0.03) 0%, transparent 60%);
    background-size: 24px 24px, 100% 100%;
    color: var(--text);
    font-family: var(--font-body);
    padding: 40px;
    min-height: 100vh;
  }

  /* ============ ANIMATION ============ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeScale {
    from { opacity: 0; transform: scale(0.92); }
    to { opacity: 1; transform: scale(1); }
  }
  .animate {
    animation: fadeUp 0.4s ease-out both;
    animation-delay: calc(var(--i, 0) * 0.06s);
  }
  .animate-scale {
    animation: fadeScale 0.35s ease-out both;
    animation-delay: calc(var(--i, 0) * 0.06s);
  }
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-delay: 0ms !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* ============ LAYOUT ============ */
  .wrap {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 170px 1fr;
    gap: 0 40px;
  }
  .main { min-width: 0; }

  /* ============ TOC ============ */
  .toc {
    position: sticky;
    top: 24px;
    align-self: start;
    padding: 14px 0;
    grid-row: 1 / -1;
    max-height: calc(100dvh - 48px);
    overflow-y: auto;
  }
  .toc::-webkit-scrollbar { width: 3px; }
  .toc::-webkit-scrollbar-thumb { background: var(--surface-elevated); border-radius: 2px; }
  .toc-title {
    font-family: var(--font-mono);
    font-size: 9px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--primary);
    padding: 0 0 10px;
    margin-bottom: 8px;
    border-bottom: 1px solid var(--border-bright);
  }
  .toc a {
    display: block;
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--text-dim);
    text-decoration: none;
    padding: 4px 8px;
    border-radius: 3px;
    border-left: 2px solid transparent;
    transition: all 0.15s;
    line-height: 1.4;
    margin-bottom: 1px;
  }
  .toc a:hover { color: var(--text); background: var(--surface2); }
  .toc a.active { color: var(--primary); border-left-color: var(--primary); }

  /* ============ HEADER ============ */
  .hazard-bar {
    height: 4px;
    background: repeating-linear-gradient(45deg, var(--hazard-a), var(--hazard-a) 10px, var(--hazard-b) 10px, var(--hazard-b) 20px);
    opacity: 0.5;
    margin-bottom: 24px;
    border-radius: 2px;
  }

  h1 {
    font-family: var(--font-display);
    font-size: 42px;
    font-weight: 700;
    letter-spacing: -1px;
    color: var(--primary);
    margin-bottom: 4px;
    text-transform: uppercase;
    text-wrap: balance;
  }

  .subtitle {
    color: var(--text-dim);
    font-family: var(--font-mono);
    font-size: 12px;
    margin-bottom: 32px;
    text-transform: uppercase;
    letter-spacing: 2px;
  }

  .description {
    font-size: 14px;
    line-height: 1.7;
    color: var(--text-dim);
    margin-bottom: 24px;
    max-width: 750px;
  }
  .description code {
    font-family: var(--font-mono);
    font-size: 12px;
    background: var(--primary-dim);
    color: var(--primary);
    padding: 1px 5px;
    border-radius: 3px;
  }

  /* ============ SECTION HEADINGS ============ */
  .sec-head {
    font-family: var(--font-display);
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--primary);
    padding: 12px 0;
    margin-top: 40px;
    margin-bottom: 16px;
    border-top: 2px solid var(--border-bright);
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .sec-head::before {
    content: '';
    width: 8px;
    height: 8px;
    background: var(--primary);
  }

  /* ============ KPI CARDS ============ */
  .kpi-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 12px;
    margin-bottom: 32px;
  }
  .kpi-card {
    background: var(--surface);
    border: 1px solid var(--border-bright);
    padding: 16px;
    position: relative;
    overflow: hidden;
  }
  .kpi-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--primary);
  }
  .kpi-card__value {
    font-family: var(--font-display);
    font-size: 32px;
    font-weight: 700;
    color: var(--primary);
    letter-spacing: -1px;
    line-height: 1.1;
  }
  .kpi-card__label {
    font-family: var(--font-mono);
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--text-dim);
    margin-top: 6px;
  }

  /* ============ MERMAID ============ */
  .mermaid-wrap {
    position: relative;
    background: var(--surface);
    border: 1px solid var(--border-bright);
    padding: 32px 24px;
    overflow: auto;
    margin-bottom: 24px;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }
  .mermaid-wrap::-webkit-scrollbar { width: 6px; height: 6px; }
  .mermaid-wrap::-webkit-scrollbar-track { background: transparent; }
  .mermaid-wrap::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  .mermaid-wrap .mermaid {
    display: flex;
    justify-content: center;
    transition: transform 0.2s ease;
    transform-origin: top center;
  }
  .fullscreen-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 10;
    width: 32px;
    height: 32px;
    border: 1px solid var(--border-bright);
    background: var(--surface);
    color: var(--text-dim);
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s ease, color 0.15s ease;
  }
  .fullscreen-btn:hover { background: var(--border); color: var(--primary); }

  /* Fullscreen overlay */
  .mermaid-wrap.is-fullscreen {
    position: fixed;
    inset: 0;
    z-index: 9999;
    border-radius: 0;
    border: none;
    margin: 0;
    padding: 40px;
    background: var(--bg);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: auto;
  }
  .mermaid-wrap.is-fullscreen .fullscreen-btn {
    position: fixed;
    top: 12px;
    right: 12px;
    z-index: 10001;
  }
  .mermaid-wrap.is-fullscreen .mermaid {
    transform-origin: center center;
  }
  .mermaid-wrap.is-zoomed { cursor: grab; }
  .mermaid-wrap.is-panning { cursor: grabbing; user-select: none; }

  /* Mermaid SVG overrides */
  .mermaid .nodeLabel {
    font-family: var(--font-body) !important;
    font-size: 14px !important;
    color: var(--text) !important;
  }
  .mermaid .edgeLabel {
    font-family: var(--font-mono) !important;
    font-size: 11px !important;
    color: var(--text-dim) !important;
    background-color: var(--bg) !important;
  }
  .mermaid .edgeLabel rect { fill: var(--bg) !important; }
  .mermaid .node rect,
  .mermaid .node circle,
  .mermaid .node polygon { stroke-width: 1.5px !important; }
  .mermaid .edge-pattern-solid { stroke-width: 1.5px !important; }

  /* ============ LEGEND ============ */
  .legend {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    margin-bottom: 24px;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .legend-swatch {
    width: 12px;
    height: 12px;
    border-radius: 2px;
  }

  /* ============ DOMAIN CARDS ============ */
  .domain-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }
  .domain-card {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 20px;
    position: relative;
    transition: border-color 0.2s ease, transform 0.2s ease;
  }
  .domain-card:hover {
    border-color: var(--border-bright);
    transform: translateY(-2px);
  }
  .domain-card__accent {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
  }
  .domain-card__label {
    font-family: var(--font-mono);
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .domain-card__label::before {
    content: '';
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
  }
  .domain-card__title {
    font-family: var(--font-display);
    font-size: 18px;
    font-weight: 700;
    text-transform: uppercase;
    margin-bottom: 12px;
    letter-spacing: -0.5px;
  }
  .domain-card__screens {
    list-style: none;
    font-size: 12px;
    line-height: 1.8;
    color: var(--text-dim);
  }
  .domain-card__screens li {
    padding-left: 14px;
    position: relative;
  }
  .domain-card__screens li::before {
    content: '>';
    position: absolute;
    left: 0;
    font-family: var(--font-mono);
    font-weight: 600;
    color: var(--text-dim);
    font-size: 10px;
  }
  .domain-card__screens code {
    font-family: var(--font-mono);
    font-size: 11px;
    background: var(--primary-dim);
    color: var(--primary);
    padding: 1px 5px;
    border-radius: 3px;
  }

  /* ============ CALLOUT ============ */
  .callout {
    background: var(--surface);
    border: 1px solid var(--border);
    border-left: 3px solid var(--primary);
    padding: 16px 20px;
    font-size: 13px;
    line-height: 1.6;
    color: var(--text-dim);
    margin-bottom: 24px;
  }
  .callout strong { color: var(--text); }
  .callout code {
    font-family: var(--font-mono);
    font-size: 11px;
    background: var(--primary-dim);
    color: var(--primary);
    padding: 1px 5px;
    border-radius: 3px;
  }

  /* ============ TECH STACK TABLE ============ */
  .table-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    overflow: hidden;
    margin-bottom: 24px;
  }
  .table-scroll { overflow-x: auto; }
  .data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
    line-height: 1.5;
  }
  .data-table th {
    background: var(--surface2);
    font-family: var(--font-mono);
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--primary);
    text-align: left;
    padding: 12px 16px;
    border-bottom: 2px solid var(--border-bright);
    white-space: nowrap;
  }
  .data-table td {
    padding: 10px 16px;
    border-bottom: 1px solid var(--border);
    vertical-align: top;
    color: var(--text);
  }
  .data-table tbody tr:nth-child(even) { background: var(--primary-dim); }
  .data-table tbody tr { transition: background 0.15s ease; }
  .data-table tbody tr:hover { background: rgba(255,204,0,0.05); }
  .data-table tbody tr:last-child td { border-bottom: none; }
  .data-table code {
    font-family: var(--font-mono);
    font-size: 11px;
    background: var(--primary-dim);
    color: var(--primary);
    padding: 1px 5px;
    border-radius: 3px;
  }

  /* tag */
  .tag {
    font-family: var(--font-mono);
    font-size: 10px;
    font-weight: 500;
    padding: 2px 7px;
    border-radius: 3px;
    display: inline-block;
  }

  /* ============ RESPONSIVE ============ */
  @media (max-width: 1000px) {
    .wrap { grid-template-columns: 1fr; padding-top: 0; }
    body { padding: 16px; padding-top: 0; }
    .toc {
      position: sticky;
      top: 0;
      z-index: 200;
      max-height: none;
      display: flex;
      gap: 4px;
      align-items: center;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      background: var(--bg);
      border-bottom: 1px solid var(--border);
      padding: 10px 0;
      margin: 0 -16px;
      padding-left: 16px;
      padding-right: 16px;
      grid-row: auto;
    }
    .toc::-webkit-scrollbar { display: none; }
    .toc-title { display: none; }
    .toc a {
      white-space: nowrap;
      flex-shrink: 0;
      border-left: none;
      border-bottom: 2px solid transparent;
      border-radius: 3px 3px 0 0;
      padding: 6px 10px;
      font-size: 10px;
    }
    .toc a.active { border-left: none; border-bottom-color: var(--primary); background: var(--surface); }
    .main { padding-top: 20px; }
    h1 { font-size: 28px; }
    .mermaid-wrap { padding: 16px 12px; }
    .domain-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<div class="wrap">

  <nav class="toc" id="toc">
    <div class="toc-title">Navigation</div>
    <a href="#s0">Overview</a>
    <a href="#s1">Auth Flow</a>
    <a href="#s2">Main Nav</a>
    <a href="#s3">Full Flow</a>
    <a href="#s4">Domains</a>
    <a href="#s5">Tech Stack</a>
    <a href="#s6">User Journey</a>
    <a href="#s7">Build Tasks</a>
  </nav>

  <div class="main">

    <div class="hazard-bar animate" style="--i:0"></div>
    <h1 class="animate" style="--i:1">KEWK</h1>
    <p class="subtitle animate" style="--i:2">Airlock Login Gateway &mdash; Full System Flow Analysis</p>

    <p class="description animate" style="--i:3">
      A military-industrial themed fitness application with <code>48 screens</code> spanning workout tracking,
      nutrition logging, program management, meditation, and recovery monitoring. Built with Tailwind CSS,
      dark-first design language, and a sci-fi aesthetic featuring hazard stripes, scanline overlays,
      chamfered buttons, and monospace HUD readouts.
    </p>

    <!-- KPI Cards -->
    <div id="s0" class="sec-head animate" style="--i:4">System Overview</div>

    <div class="kpi-row">
      <div class="kpi-card animate-scale" style="--i:5">
        <div class="kpi-card__value">48</div>
        <div class="kpi-card__label">Total Screens</div>
      </div>
      <div class="kpi-card animate-scale" style="--i:6">
        <div class="kpi-card__value">9</div>
        <div class="kpi-card__label">Domains</div>
      </div>
      <div class="kpi-card animate-scale" style="--i:7">
        <div class="kpi-card__value">4</div>
        <div class="kpi-card__label">Nav Tabs</div>
      </div>
      <div class="kpi-card animate-scale" style="--i:8">
        <div class="kpi-card__value">3</div>
        <div class="kpi-card__label">Coming Soon</div>
      </div>
      <div class="kpi-card animate-scale" style="--i:9">
        <div class="kpi-card__value">3</div>
        <div class="kpi-card__label">Admin Screens</div>
      </div>
    </div>

    <!-- AUTH FLOW -->
    <div id="s1" class="sec-head animate" style="--i:10">1 &mdash; Auth Flow</div>

    <p class="description animate" style="--i:11">
      Entry point via the <code>Airlock Login Gateway</code>. Three auth ports: Google OAuth, Apple Sign-In,
      and manual email/password. A magic link option provides passwordless entry. On auth success, the user
      passes through optional contract terms before reaching the Command Deck.
    </p>

    <div class="mermaid-wrap animate" style="--i:12">
      <button class="fullscreen-btn" onclick="toggleFullscreen(this)" title="Toggle fullscreen">&#x26F6;</button>
      <pre class="mermaid">
graph TD
  LAUNCH["App Launch"] --> GATE["Airlock Login Gateway"]
  GATE --> G["PORT_01: G-AUTH<br/>Google OAuth"]
  GATE --> A["PORT_02: i-AUTH<br/>Apple Sign-In"]
  GATE --> M["PORT_03: Manual Override<br/>Email + Password"]
  GATE --> ML["Magic Link Entry"]
  M --> STACK["Login Command Stack<br/>Email/Password Form"]
  STACK --> AUTH_CHECK{"Auth Valid?"}
  G --> AUTH_CHECK
  A --> AUTH_CHECK
  ML --> AUTH_CHECK
  AUTH_CHECK -->|"Yes"| TOS["Access Contract Terms"]
  AUTH_CHECK -->|"No"| GATE
  TOS --> COMMAND["Command Deck<br/>Home Overview"]

  classDef gate fill:#ff6b3522,stroke:#ff6b35,stroke-width:2px
  classDef auth fill:#ffcc0022,stroke:#ffcc00,stroke-width:2px
  classDef home fill:#33cc6622,stroke:#33cc66,stroke-width:2px
  classDef check fill:#ff333322,stroke:#ff3333,stroke-width:2px

  class GATE,LAUNCH gate
  class G,A,M,ML,STACK auth
  class COMMAND home
  class AUTH_CHECK,TOS check
      </pre>
    </div>

    <!-- MAIN NAVIGATION -->
    <div id="s2" class="sec-head animate" style="--i:13">2 &mdash; Bottom Navigation</div>

    <p class="description animate" style="--i:14">
      The app uses a fixed bottom navigation bar with 4 tabs. Each tab serves as a gateway
      to a cluster of related screens within a domain.
    </p>

    <div class="mermaid-wrap animate" style="--i:15">
      <button class="fullscreen-btn" onclick="toggleFullscreen(this)" title="Toggle fullscreen">&#x26F6;</button>
      <pre class="mermaid">
graph LR
  CMD["Command<br/>grid_view"] --> HOME["Command Deck<br/>Home Overview"]
  ANA["Analysis<br/>leaderboard"] --> STATS["Damage Report<br/>Body Stats"]
  LOG["Logbook<br/>history"] --> COMBAT["Combat Log<br/>Active Session"]
  PRO["Profile<br/>person"] --> SETTINGS["Mainframe<br/>Settings Hub"]

  HOME --> WORKOUT["Deploy Session"]
  HOME --> NUTRITION["Nutrition"]
  HOME --> PROGRAMS["Programs"]
  HOME --> BIOMETRICS["Biometrics"]

  classDef tab fill:#ffcc0033,stroke:#ffcc00,stroke-width:2px
  classDef screen fill:#1c1c1622,stroke:#8a856e,stroke-width:1px

  class CMD,ANA,LOG,PRO tab
  class HOME,STATS,COMBAT,SETTINGS,WORKOUT,NUTRITION,PROGRAMS,BIOMETRICS screen
      </pre>
    </div>

    <div class="legend animate" style="--i:16">
      <div class="legend-item"><div class="legend-swatch" style="background:var(--primary)"></div> Nav Tab</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--auth)"></div> Auth</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--combat)"></div> Combat / Workout</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--fuel)"></div> Nutrition / Fuel</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--recovery)"></div> Recovery / Meditation</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--program)"></div> Programs</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--settings)"></div> Settings / Admin</div>
      <div class="legend-item"><div class="legend-swatch" style="background:var(--monetize)"></div> Monetization</div>
    </div>

    <!-- FULL SYSTEM FLOW -->
    <div id="s3" class="sec-head animate" style="--i:17">3 &mdash; Full System Flow</div>

    <p class="description animate" style="--i:18">
      Complete navigation map showing how all 48 screens connect. The Command Deck is the central hub,
      with branches into each domain. Screens marked <code>COMING SOON</code> are placeholder states.
    </p>

    <div class="mermaid-wrap animate" style="--i:19">
      <button class="fullscreen-btn" onclick="toggleFullscreen(this)" title="Toggle fullscreen">&#x26F6;</button>
      <pre class="mermaid">
graph TD
  %% Auth
  LOGIN["Airlock Login Gateway"] --> CMD_STACK["Login Command Stack"]
  LOGIN --> TERMS["Access Contract Terms"]
  TERMS --> HOME["Command Deck<br/>Home Overview"]

  %% Home Hub
  HOME --> WORKOUT_FLOW
  HOME --> NUTRITION_FLOW
  HOME --> PROGRAM_FLOW
  HOME --> RECOVERY_FLOW
  HOME --> SETTINGS_FLOW

  %% Workout Domain
  subgraph WORKOUT_FLOW["COMBAT OPERATIONS"]
    COMBAT["Combat Log<br/>Active Session"]
    EXERCISE["Exercise Arsenal<br/>Picker"]
    CALC["1RM Calculator<br/>Matrix"]
    COMBAT --> EXERCISE
    COMBAT --> CALC
  end

  %% Program Domain
  subgraph PROGRAM_FLOW["PROGRAM BAY"]
    PROG_LIST["Program Bay<br/>Protocol Index"]
    PROG_DETAIL["Program Detail<br/>Protocol Breakdown"]
    PROG_BUILD["Forge<br/>Program Builder"]
    PROG_EXPORT["Program Export<br/>Data Packaging"]
    PROG_IMPORT["Program Import"]
    PROG_LIST --> PROG_DETAIL
    PROG_LIST --> PROG_BUILD
    PROG_DETAIL --> PROG_EXPORT
    PROG_LIST --> PROG_IMPORT
  end

  %% Nutrition Domain
  subgraph NUTRITION_FLOW["FUEL SECTOR"]
    FOOD_LOG["Food Log<br/>Nutrition Sync"]
    FOOD_SEARCH["Food Search<br/>Interface"]
    FOOD_DETAIL["Food Detail<br/>Nutrition Analysis"]
    FOOD_CREATE["Create Custom<br/>Fuel Food"]
    MY_FOODS["My Foods<br/>Inventory"]
    FOOD_GROUPS["Custom Food<br/>Groups Matrix"]
    TACTICAL_LOG["Tactical Food<br/>Log Fueling"]
    RECIPE["Recipe Builder<br/>Assembly"]
    RECIPE_LINE["Recipe Builder<br/>Assembly Line"]
    BARCODE["Barcode Scanner<br/>Viewfinder"]
    NUTRI_GOALS["Nutrition Mission<br/>Goals"]
    NUTRI_CAL["Nutrition Mission<br/>Calibration"]
    NUTRI_TRENDS["Nutrition<br/>Telemetry Trends"]
    NUTRI_TRENDS2["Nutrition Trends<br/>Analysis"]
    NUTRI_SOON["Nutrition Sector<br/>Coming Soon"]
    FOOD_LOG --> FOOD_SEARCH
    FOOD_SEARCH --> FOOD_DETAIL
    FOOD_SEARCH --> BARCODE
    FOOD_LOG --> FOOD_CREATE
    FOOD_LOG --> MY_FOODS
    MY_FOODS --> FOOD_GROUPS
    FOOD_LOG --> RECIPE
    RECIPE --> RECIPE_LINE
    FOOD_LOG --> TACTICAL_LOG
    NUTRI_GOALS --> NUTRI_CAL
    NUTRI_TRENDS --> NUTRI_TRENDS2
  end

  %% Recovery Domain
  subgraph RECOVERY_FLOW["RECOVERY GRID"]
    RECOVERY["Recovery Grid<br/>Readiness Status"]
    DAMAGE["Damage Report<br/>Body Stats"]
    BREATH_GUIDE["Breathing Guided<br/>Recovery"]
    BREATH_CORE["Breathing<br/>Pneumatic Core"]
    BREATH_SOON["Breathing Engine<br/>Coming Soon"]
    MEDITATION["Meditation<br/>Ambient Hub"]
    MED_TIMER["Meditation<br/>Session Timer"]
    MED_SOON["Meditation Signal<br/>Coming Soon"]
    RECOVERY --> DAMAGE
    RECOVERY --> BREATH_GUIDE
    BREATH_GUIDE --> BREATH_CORE
    BREATH_GUIDE --> BREATH_SOON
    RECOVERY --> MEDITATION
    MEDITATION --> MED_TIMER
    MEDITATION --> MED_SOON
  end

  %% Settings Domain
  subgraph SETTINGS_FLOW["MAINFRAME SETTINGS"]
    SETTINGS["Mainframe<br/>Settings Hub"]
    SYS_SETTINGS["Mainframe<br/>System Settings"]
    PRIVACY["Mainframe<br/>Privacy Policy"]
    SIGNAL_PRIV["Signal Privacy<br/>Protocol"]
    THEME["Theme Picker<br/>Protocol"]
    DATA_EXPORT["Export Data"]
    SETTINGS --> SYS_SETTINGS
    SETTINGS --> PRIVACY
    SETTINGS --> SIGNAL_PRIV
    SETTINGS --> THEME
    SETTINGS --> DATA_EXPORT
  end

  %% Monetization (accessible from settings or prompts)
  HOME --> MONETIZE_FLOW
  subgraph MONETIZE_FLOW["UPGRADE RELAY"]
    PLAN["Plan Console<br/>Tier Selection"]
    UPGRADE_MATRIX["Upgrade Plan<br/>Tier Matrix"]
    UPGRADE_CHOICE["Upgrade Relay<br/>Choice"]
    AD_GATE["Ad Gate<br/>Interstitial"]
    PLAN --> UPGRADE_MATRIX
    PLAN --> UPGRADE_CHOICE
  end

  %% Admin (hidden)
  subgraph ADMIN["ADMIN DEBUG"]
    ADMIN_ADS["Admin Ad<br/>Config Debug"]
    ADMIN_EX["Admin Exercise<br/>Review Queue"]
    ADMIN_VOICE["Admin Voice<br/>Prototype Debug"]
  end

  classDef authStyle fill:#ff6b3522,stroke:#ff6b35,stroke-width:2px
  classDef homeStyle fill:#ffcc0033,stroke:#ffcc00,stroke-width:2px
  classDef combatStyle fill:#ff333322,stroke:#ff3333,stroke-width:1.5px
  classDef fuelStyle fill:#33cc6622,stroke:#33cc66,stroke-width:1.5px
  classDef recoveryStyle fill:#6b8aff22,stroke:#6b8aff,stroke-width:1.5px
  classDef programStyle fill:#00cccc22,stroke:#00cccc,stroke-width:1.5px
  classDef settingsStyle fill:#9966ff22,stroke:#9966ff,stroke-width:1.5px
  classDef monetizeStyle fill:#ff990022,stroke:#ff9900,stroke-width:1.5px
  classDef adminStyle fill:#66666622,stroke:#666666,stroke-width:1px,stroke-dasharray: 5 5
  classDef soonStyle fill:#44444422,stroke:#444444,stroke-width:1px,stroke-dasharray: 3 3

  class LOGIN,CMD_STACK,TERMS authStyle
  class HOME homeStyle
  class COMBAT,EXERCISE,CALC combatStyle
  class FOOD_LOG,FOOD_SEARCH,FOOD_DETAIL,FOOD_CREATE,MY_FOODS,FOOD_GROUPS,TACTICAL_LOG,RECIPE,RECIPE_LINE,BARCODE,NUTRI_GOALS,NUTRI_CAL,NUTRI_TRENDS,NUTRI_TRENDS2 fuelStyle
  class RECOVERY,DAMAGE,BREATH_GUIDE,BREATH_CORE,MEDITATION,MED_TIMER recoveryStyle
  class PROG_LIST,PROG_DETAIL,PROG_BUILD,PROG_EXPORT,PROG_IMPORT programStyle
  class SETTINGS,SYS_SETTINGS,PRIVACY,SIGNAL_PRIV,THEME,DATA_EXPORT settingsStyle
  class PLAN,UPGRADE_MATRIX,UPGRADE_CHOICE,AD_GATE monetizeStyle
  class ADMIN_ADS,ADMIN_EX,ADMIN_VOICE adminStyle
  class NUTRI_SOON,BREATH_SOON,MED_SOON soonStyle
      </pre>
    </div>

    <!-- DOMAIN BREAKDOWN -->
    <div id="s4" class="sec-head animate" style="--i:20">4 &mdash; Domain Breakdown</div>

    <div class="domain-grid">
      <div class="domain-card animate" style="--i:21">
        <div class="domain-card__accent" style="background: var(--auth)"></div>
        <div class="domain-card__label" style="color: var(--auth)">Auth_Gate</div>
        <div class="domain-card__title">Airlock Authentication</div>
        <ul class="domain-card__screens">
          <li><code>airlock_login_gateway</code> &mdash; Landing with 4 auth methods</li>
          <li><code>airlock_login_command_stack</code> &mdash; Email/password form</li>
          <li><code>access_contract_terms</code> &mdash; Terms of service</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:22">
        <div class="domain-card__accent" style="background: var(--primary)"></div>
        <div class="domain-card__label" style="color: var(--primary)">Command_Deck</div>
        <div class="domain-card__title">Home Dashboard</div>
        <ul class="domain-card__screens">
          <li><code>command_deck_home_overview</code> &mdash; Today's objective, quick actions, recovery bar</li>
          <li>Training cadence week strip (M-T-W-T-F-S-S)</li>
          <li>Quick action grid: Biometrics, Nutrition, Workouts, Programs</li>
          <li>Deploy Session button (launches combat log)</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:23">
        <div class="domain-card__accent" style="background: var(--combat)"></div>
        <div class="domain-card__label" style="color: var(--combat)">Combat_Zone</div>
        <div class="domain-card__title">Workout Execution</div>
        <ul class="domain-card__screens">
          <li><code>combat_log_active_session</code> &mdash; Live workout with timer, set/rep/weight input</li>
          <li><code>exercise_arsenal_picker</code> &mdash; Exercise library browser</li>
          <li><code>1rm_calculator_matrix</code> &mdash; One-rep max calculator</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:24">
        <div class="domain-card__accent" style="background: var(--program)"></div>
        <div class="domain-card__label" style="color: var(--program)">Program_Bay</div>
        <div class="domain-card__title">Program Management</div>
        <ul class="domain-card__screens">
          <li><code>program_bay_protocol_index</code> &mdash; Program library listing</li>
          <li><code>program_detail_protocol_breakdown</code> &mdash; Full program view</li>
          <li><code>forge_program_builder</code> &mdash; Create custom programs</li>
          <li><code>program_export_data_packaging</code> &mdash; Export</li>
          <li><code>untitled_screen_2</code> &mdash; Import</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:25">
        <div class="domain-card__accent" style="background: var(--fuel)"></div>
        <div class="domain-card__label" style="color: var(--fuel)">Fuel_Sector</div>
        <div class="domain-card__title">Nutrition &amp; Food Tracking</div>
        <ul class="domain-card__screens">
          <li><code>food_log_nutrition_sync</code> &mdash; Daily food log</li>
          <li><code>food_search_interface</code> &mdash; Food search with barcode scanner</li>
          <li><code>food_detail_nutrition_analysis</code> &mdash; Macro/micro breakdown</li>
          <li><code>create_custom_fuel_food</code> &mdash; Create custom foods</li>
          <li><code>my_foods_inventory</code> &mdash; Saved foods list</li>
          <li><code>custom_food_groups_matrix</code> &mdash; Food categories</li>
          <li><code>tactical_food_log_fueling</code> &mdash; Quick-log view</li>
          <li><code>recipe_builder_assembly</code> + <code>assembly_line</code> &mdash; Recipe creation</li>
          <li><code>barcode_scanner_viewfinder</code> &mdash; Camera barcode scan</li>
          <li><code>nutrition_mission_goals</code> &mdash; Target setup</li>
          <li><code>nutrition_mission_calibration</code> &mdash; TDEE/macro tuning</li>
          <li><code>nutrition_telemetry_trends</code> + <code>trends_analysis</code> &mdash; Charts</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:26">
        <div class="domain-card__accent" style="background: var(--recovery)"></div>
        <div class="domain-card__label" style="color: var(--recovery)">Recovery_Grid</div>
        <div class="domain-card__title">Recovery &amp; Meditation</div>
        <ul class="domain-card__screens">
          <li><code>recovery_grid_readiness_status</code> &mdash; Overall readiness %</li>
          <li><code>damage_report_body_stats</code> &mdash; Body measurements/weight</li>
          <li><code>breathing_guided_recovery</code> &mdash; Breathwork sessions</li>
          <li><code>breathing_pneumatic_core</code> &mdash; Breathing exercise player</li>
          <li><code>meditation_ambient_hub</code> &mdash; Ambient sound selection</li>
          <li><code>meditation_session_timer</code> &mdash; Timer + session tracking</li>
          <li>3 "Coming Soon" placeholder screens</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:27">
        <div class="domain-card__accent" style="background: var(--settings)"></div>
        <div class="domain-card__label" style="color: var(--settings)">Mainframe</div>
        <div class="domain-card__title">Settings &amp; Configuration</div>
        <ul class="domain-card__screens">
          <li><code>mainframe_settings_hub</code> &mdash; Main settings menu</li>
          <li><code>mainframe_system_settings</code> &mdash; App preferences</li>
          <li><code>mainframe_privacy_policy</code> &mdash; Privacy policy</li>
          <li><code>signal_privacy_protocol</code> &mdash; Data privacy controls</li>
          <li><code>theme_picker_protocol</code> &mdash; Theme customization</li>
          <li><code>untitled_screen_1</code> &mdash; Data export</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:28">
        <div class="domain-card__accent" style="background: var(--monetize)"></div>
        <div class="domain-card__label" style="color: var(--monetize)">Upgrade_Relay</div>
        <div class="domain-card__title">Monetization</div>
        <ul class="domain-card__screens">
          <li><code>plan_console_tier_selection</code> &mdash; Free vs Premium comparison matrix</li>
          <li><code>upgrade_plan_tier_matrix</code> &mdash; Pricing tiers</li>
          <li><code>upgrade_relay_choice</code> &mdash; Upgrade CTA</li>
          <li><code>ad_gate_interstitial</code> &mdash; Ad interstitial (free tier)</li>
        </ul>
      </div>

      <div class="domain-card animate" style="--i:29">
        <div class="domain-card__accent" style="background: #666"></div>
        <div class="domain-card__label" style="color: #888">Admin_Debug</div>
        <div class="domain-card__title">Admin Panel</div>
        <ul class="domain-card__screens">
          <li><code>admin_ad_config_debug</code> &mdash; Ad configuration</li>
          <li><code>admin_exercise_review_queue</code> &mdash; Exercise moderation</li>
          <li><code>admin_voice_prototype_debug</code> &mdash; Voice AI prototype</li>
        </ul>
      </div>
    </div>

    <!-- TECH STACK -->
    <div id="s5" class="sec-head animate" style="--i:30">5 &mdash; Tech Stack &amp; Design System</div>

    <div class="table-wrap animate" style="--i:31">
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th>Layer</th>
              <th>Technology</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Framework</td>
              <td><code>Tailwind CSS</code> via CDN</td>
              <td>With forms + container-queries plugins</td>
            </tr>
            <tr>
              <td>Fonts</td>
              <td><code>Space Grotesk</code>, <code>Chakra Petch</code>, <code>Orbitron</code>, <code>Share Tech Mono</code></td>
              <td>Display, industrial headings, labels, monospace HUD</td>
            </tr>
            <tr>
              <td>Icons</td>
              <td><code>Material Symbols Outlined</code></td>
              <td>Google Fonts icon family</td>
            </tr>
            <tr>
              <td>Color</td>
              <td><code>#ffcc00</code> primary on <code>#0a0a08</code> void black</td>
              <td>High-contrast amber on dark, industrial aesthetic</td>
            </tr>
            <tr>
              <td>Theme</td>
              <td>Dark mode default</td>
              <td>Tailwind <code>darkMode: "class"</code>, HTML has <code>class="dark"</code></td>
            </tr>
            <tr>
              <td>Shapes</td>
              <td>Chamfered corners via <code>clip-path: polygon()</code></td>
              <td>Military/industrial cut-corner buttons and cards</td>
            </tr>
            <tr>
              <td>Effects</td>
              <td>Scanline overlay, hazard stripes, glow shadows</td>
              <td>CRT scanline, 45deg yellow/black stripes, box-shadow glows</td>
            </tr>
            <tr>
              <td>Layout</td>
              <td>Mobile-first, <code>max-w-md</code> container</td>
              <td>Fixed bottom nav, sticky headers, iOS-style status bar</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- USER JOURNEY -->
    <div id="s6" class="sec-head animate" style="--i:32">6 &mdash; Primary User Journey</div>

    <p class="description animate" style="--i:33">
      The core workout loop: authenticate, view today's objective, deploy a session, log sets,
      complete the workout, review recovery status. Nutrition logging runs as a parallel daily activity.
    </p>

    <div class="mermaid-wrap animate" style="--i:34">
      <button class="fullscreen-btn" onclick="toggleFullscreen(this)" title="Toggle fullscreen">&#x26F6;</button>
      <pre class="mermaid">
graph TD
  A["Open App"] --> B["Airlock Login"]
  B --> C["Command Deck"]
  C --> D["View Today's Objective<br/>HYPERTROPHY_A: LEGS"]
  D --> E["DEPLOY SESSION"]
  E --> F["Combat Log<br/>Active Session"]
  F --> G["Select Exercise<br/>SQUAT - ALPHA UNIT"]
  G --> H["Input Weight + Reps<br/>140 KG x 5"]
  H --> I["COMMIT DATA<br/>Log Set"]
  I --> J{"More Sets?"}
  J -->|"Yes"| H
  J -->|"No"| K{"More Exercises?"}
  K -->|"Yes"| G
  K -->|"No"| L["Session Complete<br/>Total Volume: 14,200 KG"]
  L --> M["Recovery Grid<br/>Readiness: 75%"]
  M --> C

  C --> N["Food Search"]
  N --> O["Log Meals"]
  O --> P["Nutrition Trends"]
  P --> C

  classDef action fill:#ffcc0022,stroke:#ffcc00,stroke-width:2px
  classDef decision fill:#ff333322,stroke:#ff3333,stroke-width:2px
  classDef complete fill:#33cc6622,stroke:#33cc66,stroke-width:2px

  class A,B,C,D,E,F,G,H,I,N,O,P action
  class J,K decision
  class L,M complete
      </pre>
    </div>

    <div class="callout animate" style="--i:35">
      <strong>Design Language.</strong> Every screen uses a consistent military-industrial vocabulary:
      login = <code>Airlock</code>, home = <code>Command Deck</code>, workouts = <code>Combat Log</code>,
      food = <code>Fuel Sector</code>, programs = <code>Protocol</code>, settings = <code>Mainframe</code>,
      body stats = <code>Damage Report</code>, recovery = <code>Recovery Grid</code>. Sets are
      <code>committed</code>, exercises are <code>objectives</code>, and the user is an <code>Operator</code>.
    </div>

    <!-- BUILD TASK LIST -->
    <div id="s7" class="sec-head animate" style="--i:36">7 &mdash; Prioritized Build Tasks</div>

    <p class="description animate" style="--i:37">
      Implementation roadmap organized by priority tier. <code>P0</code> is foundational infrastructure
      that everything else depends on. Each subsequent tier builds on the previous. Estimated scope
      assumes a solo developer with the screen prototypes as reference.
    </p>

    <div class="table-wrap animate" style="--i:38">
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th style="width:50px">Pri</th>
              <th>Task</th>
              <th>Domain</th>
              <th>Screens</th>
              <th>Dependencies</th>
            </tr>
          </thead>
          <tbody>
            <!-- P0 -->
            <tr>
              <td><span class="tag" style="background:#ff333322;color:#ff3333">P0</span></td>
              <td><strong>Design system &amp; theme engine</strong><br><small>Tailwind config, CSS variables, chamfer clips, hazard stripes, scanline overlay, font stack (Space Grotesk, Chakra Petch, Orbitron, Share Tech Mono)</small></td>
              <td>Foundation</td>
              <td>All 48</td>
              <td>None</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ff333322;color:#ff3333">P0</span></td>
              <td><strong>App shell &amp; bottom navigation</strong><br><small>Fixed bottom nav bar (Command, Analysis, Logbook, Profile), route structure, max-w-md container, iOS status bar</small></td>
              <td>Foundation</td>
              <td>All tabbed screens</td>
              <td>Design system</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ff333322;color:#ff3333">P0</span></td>
              <td><strong>Authentication flow</strong><br><small>Google OAuth, Apple Sign-In, email/password, magic link. Airlock Login Gateway + Login Command Stack + session management</small></td>
              <td><span class="tag" style="background:var(--auth-dim);color:var(--auth)">Auth</span></td>
              <td>3</td>
              <td>App shell</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ff333322;color:#ff3333">P0</span></td>
              <td><strong>User profile &amp; data model</strong><br><small>User entity, preferences, operator identity, onboarding state. Backend API or local storage layer</small></td>
              <td>Foundation</td>
              <td>&mdash;</td>
              <td>Auth</td>
            </tr>
            <!-- P1 -->
            <tr>
              <td><span class="tag" style="background:#ffcc0022;color:#ffcc00">P1</span></td>
              <td><strong>Command Deck home screen</strong><br><small>Today's objective card, training cadence week strip, quick action grid (4 tiles), recovery status bar, deploy session CTA</small></td>
              <td><span class="tag" style="background:var(--primary-dim);color:var(--primary)">Home</span></td>
              <td>1</td>
              <td>Auth, User profile</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ffcc0022;color:#ffcc00">P1</span></td>
              <td><strong>Exercise data model &amp; arsenal picker</strong><br><small>Exercise library with categories, search, muscle groups. This feeds the workout logger and program builder</small></td>
              <td><span class="tag" style="background:var(--combat-dim);color:var(--combat)">Combat</span></td>
              <td>1</td>
              <td>Data model</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ffcc0022;color:#ffcc00">P1</span></td>
              <td><strong>Combat Log &mdash; active workout session</strong><br><small>Mission timer, exercise selection, set/rep/weight input grid, commit data (log set), session history, total volume footer. This is the core loop</small></td>
              <td><span class="tag" style="background:var(--combat-dim);color:var(--combat)">Combat</span></td>
              <td>1</td>
              <td>Exercise data</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ffcc0022;color:#ffcc00">P1</span></td>
              <td><strong>Program data model &amp; protocol index</strong><br><small>Programs with weeks/days/exercises. Program Bay list view with cards. Program Detail breakdown view</small></td>
              <td><span class="tag" style="background:var(--program-dim);color:var(--program)">Programs</span></td>
              <td>2</td>
              <td>Exercise data</td>
            </tr>
            <!-- P2 -->
            <tr>
              <td><span class="tag" style="background:#33cc6622;color:#33cc66">P2</span></td>
              <td><strong>Program builder (Forge)</strong><br><small>Create custom programs: add weeks, days, exercises, sets/reps/RPE. Import/export functionality</small></td>
              <td><span class="tag" style="background:var(--program-dim);color:var(--program)">Programs</span></td>
              <td>3</td>
              <td>Program data model</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#33cc6622;color:#33cc66">P2</span></td>
              <td><strong>Food data model &amp; search interface</strong><br><small>Food database integration, search with filters, food detail nutrition analysis (macros/micros)</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>2</td>
              <td>User profile</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#33cc6622;color:#33cc66">P2</span></td>
              <td><strong>Food logging &amp; daily tracker</strong><br><small>Food Log Nutrition Sync, Tactical Food Log, meal entries by time. Daily macro totals and progress bars</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>2</td>
              <td>Food data</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#33cc6622;color:#33cc66">P2</span></td>
              <td><strong>1RM calculator</strong><br><small>Calculator matrix with multiple formulas (Epley, Brzycki, etc). Input weight + reps, output estimated 1RM</small></td>
              <td><span class="tag" style="background:var(--combat-dim);color:var(--combat)">Combat</span></td>
              <td>1</td>
              <td>Exercise data</td>
            </tr>
            <!-- P3 -->
            <tr>
              <td><span class="tag" style="background:#6b8aff22;color:#6b8aff">P3</span></td>
              <td><strong>Custom foods, food groups &amp; my foods</strong><br><small>Create Custom Fuel Food form, My Foods Inventory list, Custom Food Groups categorization</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>3</td>
              <td>Food logging</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#6b8aff22;color:#6b8aff">P3</span></td>
              <td><strong>Barcode scanner</strong><br><small>Camera-based barcode viewfinder, lookup food by barcode, auto-populate nutrition data</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>1</td>
              <td>Food data</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#6b8aff22;color:#6b8aff">P3</span></td>
              <td><strong>Recipe builder</strong><br><small>Recipe Builder Assembly + Assembly Line. Combine ingredients, calculate per-serving macros, save as custom food</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>2</td>
              <td>Custom foods</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#6b8aff22;color:#6b8aff">P3</span></td>
              <td><strong>Nutrition goals &amp; calibration</strong><br><small>Nutrition Mission Goals setup + Calibration (TDEE calculation, macro splits, target adjustment)</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>2</td>
              <td>Food logging</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#6b8aff22;color:#6b8aff">P3</span></td>
              <td><strong>Body stats &amp; damage report</strong><br><small>Weight tracking, body measurements, progress photos, trend charts</small></td>
              <td><span class="tag" style="background:var(--recovery-dim);color:var(--recovery)">Recovery</span></td>
              <td>1</td>
              <td>User profile</td>
            </tr>
            <!-- P4 -->
            <tr>
              <td><span class="tag" style="background:#9966ff22;color:#9966ff">P4</span></td>
              <td><strong>Nutrition trends &amp; analytics</strong><br><small>Nutrition Telemetry Trends + Trends Analysis. Charts for macro intake over time, adherence tracking</small></td>
              <td><span class="tag" style="background:var(--fuel-dim);color:var(--fuel)">Fuel</span></td>
              <td>2</td>
              <td>Food logging, Nutrition goals</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#9966ff22;color:#9966ff">P4</span></td>
              <td><strong>Recovery grid &amp; readiness status</strong><br><small>Overall readiness percentage, CNS load indicator, segmented readiness bar, muscle group recovery map</small></td>
              <td><span class="tag" style="background:var(--recovery-dim);color:var(--recovery)">Recovery</span></td>
              <td>1</td>
              <td>Workout logging, Body stats</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#9966ff22;color:#9966ff">P4</span></td>
              <td><strong>Settings hub &amp; system settings</strong><br><small>Mainframe Settings Hub, System Settings, Theme Picker Protocol, Privacy Policy, Signal Privacy Protocol</small></td>
              <td><span class="tag" style="background:var(--settings-dim);color:var(--settings)">Settings</span></td>
              <td>5</td>
              <td>User profile</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#9966ff22;color:#9966ff">P4</span></td>
              <td><strong>Data export &amp; import</strong><br><small>Export Data packaging, Program Import. JSON/CSV export of workout history, programs, nutrition logs</small></td>
              <td><span class="tag" style="background:var(--settings-dim);color:var(--settings)">Settings</span></td>
              <td>2</td>
              <td>All data models</td>
            </tr>
            <!-- P5 -->
            <tr>
              <td><span class="tag" style="background:#ff990022;color:#ff9900">P5</span></td>
              <td><strong>Breathing &amp; meditation</strong><br><small>Breathing Guided Recovery, Pneumatic Core (exercise player), Meditation Ambient Hub, Session Timer. Ambient sound playback + breath pacing</small></td>
              <td><span class="tag" style="background:var(--recovery-dim);color:var(--recovery)">Recovery</span></td>
              <td>4</td>
              <td>App shell</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#ff990022;color:#ff9900">P5</span></td>
              <td><strong>Monetization &amp; upgrade flow</strong><br><small>Plan Console Tier Selection (comparison matrix), Upgrade Plan Tier Matrix (pricing), Upgrade Relay Choice (CTA), Ad Gate Interstitial (free tier ads)</small></td>
              <td><span class="tag" style="background:var(--monetize-dim);color:var(--monetize)">Upgrade</span></td>
              <td>4</td>
              <td>Auth, User profile</td>
            </tr>
            <!-- P6 -->
            <tr>
              <td><span class="tag" style="background:#66666622;color:#888">P6</span></td>
              <td><strong>Admin panel</strong><br><small>Ad Config Debug, Exercise Review Queue, Voice Prototype Debug. Internal tools for content moderation and configuration</small></td>
              <td><span class="tag" style="background:#66666622;color:#888">Admin</span></td>
              <td>3</td>
              <td>All systems</td>
            </tr>
            <tr>
              <td><span class="tag" style="background:#66666622;color:#888">P6</span></td>
              <td><strong>"Coming Soon" placeholders</strong><br><small>Breathing Engine, Meditation Signal, Nutrition Sector. Stub screens with teaser content and notification signup</small></td>
              <td>Various</td>
              <td>3</td>
              <td>App shell</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" style="background:var(--surface2);font-weight:600;font-size:12px;border-top:2px solid var(--border-bright);color:var(--primary)">TOTAL</td>
              <td style="background:var(--surface2);font-weight:600;font-size:12px;border-top:2px solid var(--border-bright);color:var(--primary)">48</td>
              <td style="background:var(--surface2);font-size:11px;border-top:2px solid var(--border-bright);color:var(--text-dim)">7 priority tiers</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <div class="callout animate" style="--i:39">
      <strong>Build order rationale.</strong> <code>P0</code> establishes the visual identity and auth &mdash; nothing works without these.
      <code>P1</code> delivers the core workout loop (the reason anyone downloads a fitness app).
      <code>P2</code> adds program building and basic nutrition &mdash; the two features that drive retention.
      <code>P3</code> deepens the nutrition system with custom foods, recipes, and barcode scanning.
      <code>P4</code> adds analytics, recovery tracking, and settings &mdash; polish that makes the app feel complete.
      <code>P5</code> introduces wellness features and monetization.
      <code>P6</code> is admin tooling and placeholder screens &mdash; ship last.
    </div>

    <!-- Priority summary bar -->
    <div class="kpi-row animate" style="--i:40">
      <div class="kpi-card" style="border-top: 3px solid #ff3333">
        <div class="kpi-card__value" style="color:#ff3333">P0</div>
        <div class="kpi-card__label">Foundation</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">4 tasks / 3 screens</div>
      </div>
      <div class="kpi-card" style="border-top: 3px solid #ffcc00">
        <div class="kpi-card__value" style="color:#ffcc00">P1</div>
        <div class="kpi-card__label">Core Loop</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">4 tasks / 5 screens</div>
      </div>
      <div class="kpi-card" style="border-top: 3px solid #33cc66">
        <div class="kpi-card__value" style="color:#33cc66">P2</div>
        <div class="kpi-card__label">Nutrition + Build</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">4 tasks / 8 screens</div>
      </div>
      <div class="kpi-card" style="border-top: 3px solid #6b8aff">
        <div class="kpi-card__value" style="color:#6b8aff">P3</div>
        <div class="kpi-card__label">Deep Nutrition</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">5 tasks / 9 screens</div>
      </div>
      <div class="kpi-card" style="border-top: 3px solid #9966ff">
        <div class="kpi-card__value" style="color:#9966ff">P4</div>
        <div class="kpi-card__label">Analytics + Settings</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">4 tasks / 10 screens</div>
      </div>
      <div class="kpi-card" style="border-top: 3px solid #ff9900">
        <div class="kpi-card__value" style="color:#ff9900">P5</div>
        <div class="kpi-card__label">Wellness + Revenue</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">2 tasks / 8 screens</div>
      </div>
      <div class="kpi-card" style="border-top: 3px solid #666">
        <div class="kpi-card__value" style="color:#888">P6</div>
        <div class="kpi-card__label">Admin + Stubs</div>
        <div style="font-family:var(--font-mono);font-size:11px;color:var(--text-dim);margin-top:4px">2 tasks / 6 screens</div>
      </div>
    </div>

    <div class="hazard-bar animate" style="--i:41"></div>
    <p style="font-family: var(--font-mono); font-size: 10px; color: var(--text-dim); text-align: center; text-transform: uppercase; letter-spacing: 2px; padding: 16px 0;">
      KEWK Industries // System Analysis Complete // 48 Screens Mapped // 25 Build Tasks Queued
    </p>

  </div><!-- /main -->

</div><!-- /wrap -->

<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  import elkLayouts from 'https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk/dist/mermaid-layout-elk.esm.min.mjs';

  const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

  mermaid.registerLayoutLoaders(elkLayouts);
  mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    look: 'classic',
    layout: 'elk',
    themeVariables: {
      primaryColor: isDark ? '#1c1c16' : '#fefce8',
      primaryBorderColor: isDark ? '#ffcc00' : '#b38f00',
      primaryTextColor: isDark ? '#e8e4d0' : '#1a1a0e',
      secondaryColor: isDark ? '#1a1612' : '#fff7ed',
      secondaryBorderColor: isDark ? '#ff6b35' : '#cc5528',
      secondaryTextColor: isDark ? '#e8e4d0' : '#1a1a0e',
      tertiaryColor: isDark ? '#141a14' : '#f0fdf4',
      tertiaryBorderColor: isDark ? '#33cc66' : '#1a8040',
      tertiaryTextColor: isDark ? '#e8e4d0' : '#1a1a0e',
      lineColor: isDark ? '#8a856e' : '#6b6650',
      fontSize: '14px',
      fontFamily: "'Space Grotesk', system-ui, sans-serif",
      noteBkgColor: isDark ? '#1c1c16' : '#fefce8',
      noteTextColor: isDark ? '#e8e4d0' : '#1a1a0e',
      noteBorderColor: isDark ? '#ffcc00' : '#b38f00',
    }
  });
</script>
<script>
  function toggleFullscreen(btn) {
    var wrap = btn.closest('.mermaid-wrap');
    var target = wrap.querySelector('.mermaid');
    var isFS = wrap.classList.toggle('is-fullscreen');
    btn.innerHTML = isFS ? '&#x2715;' : '&#x26F6;';
    btn.title = isFS ? 'Exit fullscreen' : 'Toggle fullscreen';
    if (!isFS) {
      target.dataset.zoom = '1';
      target.style.transform = 'scale(1)';
      wrap.classList.remove('is-zoomed');
    }
    document.body.style.overflow = isFS ? 'hidden' : '';
  }

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      var fs = document.querySelector('.mermaid-wrap.is-fullscreen');
      if (fs) toggleFullscreen(fs.querySelector('.fullscreen-btn'));
    }
  });

  document.querySelectorAll('.mermaid-wrap').forEach(function(wrap) {
    // Scroll to zoom — no modifier key needed
    wrap.addEventListener('wheel', function(e) {
      e.preventDefault();
      var target = wrap.querySelector('.mermaid');
      var current = parseFloat(target.dataset.zoom || '1');
      var factor = e.deltaY < 0 ? 1.15 : 0.87;
      var maxZoom = wrap.classList.contains('is-fullscreen') ? 20 : 8;
      var next = Math.min(Math.max(current * factor, 0.2), maxZoom);
      target.dataset.zoom = next;
      target.style.transform = 'scale(' + next + ')';
      wrap.classList.toggle('is-zoomed', next > 1);
    }, { passive: false });

    // Click-and-drag to pan when zoomed
    var startX, startY, scrollL, scrollT;
    wrap.addEventListener('mousedown', function(e) {
      if (e.target.closest('.fullscreen-btn')) return;
      var target = wrap.querySelector('.mermaid');
      if (parseFloat(target.dataset.zoom || '1') <= 1) return;
      wrap.classList.add('is-panning');
      startX = e.clientX;
      startY = e.clientY;
      scrollL = wrap.scrollLeft;
      scrollT = wrap.scrollTop;
    });
    window.addEventListener('mousemove', function(e) {
      if (!wrap.classList.contains('is-panning')) return;
      wrap.scrollLeft = scrollL - (e.clientX - startX);
      wrap.scrollTop = scrollT - (e.clientY - startY);
    });
    window.addEventListener('mouseup', function() {
      wrap.classList.remove('is-panning');
    });
  });

  // Scroll spy
  (function() {
    const toc = document.getElementById('toc');
    const links = toc.querySelectorAll('a');
    const sections = [];
    links.forEach(link => {
      const id = link.getAttribute('href').slice(1);
      const el = document.getElementById(id);
      if (el) sections.push({ id, el, link });
    });
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          links.forEach(l => l.classList.remove('active'));
          const match = sections.find(s => s.el === entry.target);
          if (match) {
            match.link.classList.add('active');
            if (window.innerWidth <= 1000) {
              match.link.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }
          }
        }
      });
    }, { rootMargin: '-10% 0px -80% 0px' });
    sections.forEach(s => observer.observe(s.el));
    links.forEach(link => {
      link.addEventListener('click', e => {
        e.preventDefault();
        const id = link.getAttribute('href').slice(1);
        const el = document.getElementById(id);
        if (el) {
          el.scrollIntoView({ behavior: 'smooth', block: 'start' });
          history.replaceState(null, '', '#' + id);
        }
      });
    });
  })();
</script>

</body>
</html>
